# Kuawase 取扱説明書（ユーザーマニュアル）

## 1. ソフトウェア概要

『Kuawase』は、句合わせ形式の試合を円滑に運営するためのプレゼンテーション支援ソフトウェアです。

- Excel形式の試合データを読み込み、簡単に対戦指定ができます。
- BGMの設定が可能です。
- 観客向けのプロジェクター表示と、運営者向けの管理パネルを分離しています。
- オフラインで使用可能、アップデートの確認以外に外部と通信を行いません。

---

## 2. 動作環境

**対応OS**
- Windows 10以降

**必要なソフトウェア**
- Excel（またはExcel互換のxlsxファイルが作成可能なソフトウェア）  
  ※Googleスプレッドシートも使用可能

---

## 3. インストール方法

1. 最新版のインストーラ（.exeファイル）をダウンロードします。  
2. ダウンロードしたファイルをダブルクリックし、画面の指示に従ってインストールを完了させます。  
3. デスクトップまたはスタートメニューに生成された『Kuawase』のショートカットをクリックして起動します。

---

## 4. 画面構成

『Kuawase』は、以下の2つのウィンドウで構成されています。

### ■ 管理ウィンドウ（管理者向け）

- **投影パネル（左上領域）**  
  - 試合内容の表示（大会名・紅白チーム名・兼題・句）  
    ※投影ウィンドウの内容がリアルタイムで反映されます。

- **対戦指定パネル（左下領域）**  
  - 対戦指定（紅白チーム名、兼題、対戦名）

- **管理パネル（右側領域）**  
  - 対戦切り替え  
  - 披講  
  - BGM再生  
  - ▼ タイマー  
  - ▶ Excelファイル管理  
  - ▶ BGMファイル管理  
  - ▶ テーマカラー  

> ※▼・▶のマークがある項目は、項目名をクリックすることで展開・折りたたみが可能です。  
> ※▼は既定で展開、▶は既定で折りたたみの状態です。  
> ※「大会TOP」「対戦TOP」画面では、「披講」は表示されません。

### ■ 投影ウィンドウ（選手・観客向け）

- 試合内容の表示（大会名・紅白チーム名・兼題・句）

---

## 5. 基本操作方法

### 5.1 Excelデータの読み込み

- ExcelデータのテンプレートはGitHubで配布しています。編集はテンプレートの指示に従ってください。  
1. 管理パネル ＞「Excelファイル管理」＞「ファイルを選択」で試合用のxlsxファイルを選択  
2. ファイルを読み込むと、管理ウィンドウ上部に「Excelデータを読み込みました！」と表示され、自動的に再読み込みされて内容が反映されます。  
   ※「ファイルを選択」の横にある表示は、再読み込み後「選択されていません」に戻ります。

### 5.2 対戦指定の方法

「対戦指定パネル」で以下を選択します：  
- 紅チーム  
- 白チーム  
- 兼題  
- 対戦名  

「保存」ボタンをクリックすると、管理ウィンドウ上部に「対戦指定を保存しました！」と表示され、自動で再読み込みされます。  
※「対戦名」欄には HTMLタグ（例：`<br>`で改行）を使用可能です。

### 5.3 試合時の操作

1. 試合の進行に応じて「大会TOP」「対戦TOP」「先鋒戦」～「大将戦」などのボタンをクリック  
2. 「紅 表示」「白 表示」ボタンで各チームの句を表示  
> ※「大会TOP」「対戦TOP」では「披講」は表示されません。

### 5.4 読み込みデータのリセット

- 「Excelファイル管理」＞「初期化」ボタンで、読み込まれたExcelデータ・対戦指定・BGM設定を削除します。  
> ※アップロードされたBGMファイルは削除されません。削除するには「BGMファイル管理」欄の「削除」ボタンを使用してください。

### 5.5 画面の拡大・縮小

- `Ctrl` + `-` : 縮小  
- `Ctrl` + `Shift` + `+` : 拡大  
- `Ctrl` + `0` : 既定の倍率に戻る

---

## 6. タイマーの操作

- 「▼タイマー」で展開  
- 各タイマー上部で時間を設定し「保存」  
- 「開始」でカウントダウン、「一時停止」で一時停止、「リセット」でリセット  
- タイマー終了時にBGMが再生されます

**1分前・そこまでの表示**  
上側タイマーで残り時間が1分・0秒になると、それぞれ「1分前」「そこまで」と表示されます  
※管理パネルの上側タイマー欄にのみ表示され、投影ウィンドウには表示されません  

- BGMを止めるにはタイマーの「リセット」ボタンを押します。  
- 上側タイマーが0秒になると、下側タイマーは動作中でも自動でリセットされます。  
- タイマーを使用しない場合、「▼タイマー」をクリックして折りたたみが可能です。

---

## 7. BGMの設定方法

1. 「BGMファイル管理」＞「ファイル選択」で音声ファイル（mp3, wavなど）を選択し、「アップロード」  
2. アップロード後、「BGMファイル管理」に一覧表示され、「削除」ボタンも使用可能  
   > ※元ファイルは削除されません（Kuawaseが利用可能なディレクトリ内に存在するコピーのみ削除）  
3. シーンごとにBGMを設定し、「BGM設定保存」で保存  
4. 音声ファイルと設定は再起動後も保持されます  

**設定可能なシーン**  
- 披講  
- 入場  
- 退場  
- 待機  
- タイマー終了（各タイマー設定可能）  

**注意事項**  
- 複数のBGMは同時に流れず、新しいものが再生されると上書きされます（タイマー・披講などすべてのシーンに適用）。  
- 現在再生中のBGMと同じファイルを再生しようとすると、再生位置が先頭に戻り、最初から再生し直されます。  
- **「待機ループ」**チェックボックスをONにすると、「待機」シーンのBGMが**「停止」**ボタンを押すまでループ再生されます。  
  - BGM再生中にチェックボックスをON/OFFしても、設定はリアルタイムに反映されます。

---

## 8. 色テーマのカスタマイズ

「▶テーマカラー」から変更可能：  
- 約10種類のテーマから選択可能  
- 選択内容は即時反映されます

---

## 9. ソフトウェアのアップデート方法

- 『Kuawase』は起動時に自動的にアップデートを確認し、新しいバージョンがある場合は自動更新されます。

---

## 10. トラブルシューティング

- **▶のついている項目が表示されない**  
  → 項目名をクリックして展開してください。

- **タイマーが邪魔**  
  → 「▼タイマー」をクリックで折りたたみ可能です。  
  ※折りたたんでもタイマー動作は継続します。

- **Excelデータが読み込まれない**  
  → 「選択されていません」表示に戻るのは正常動作です。  
  → 読み込み成功時は「Excelデータを読み込みました！」と表示されます。  
  → 大会名などが正しく表示されていれば、Excelデータは読み込まれています。  
  → 読み込みが失敗する場合は再読み込みや再起動を試してください。

- **BGMが再生されない**  
  → 「BGM設定保存」ボタンを押したか確認してください。  
  → 音量設定が0でないかも確認してください。

- **投影画面に大会名・チーム名・兼題・句が表示されない**  
  → Excelデータの読み込みと、対戦指定パネルの保存操作を確認してください。

- **対戦指定パネルが使えない**  
  → Excelデータが読み込まれていないと操作できません。

---

## 11. 注意事項

- 試合データやBGMファイルは、事前に十分なテストを行ってください。

---

## 12. 著作権・ライセンス

『Kuawase』は、オープンソースライセンスに基づいています。  
詳しくは付属のライセンスファイルをご参照ください。

---

## 13. 開発元・サポート窓口

- GitHub: https://github.com/blackstraysheep/Kuawase  
- 不具合報告・機能要望は GitHub の Issues までお願いします。

---

© 2025 BlackStraySheep  
All rights reserved.
