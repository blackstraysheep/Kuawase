
# Kuawase 取扱説明書

## 1. はじめに

『Kuawase』は、俳句や短歌などの「句合わせ」形式の対戦を、スムーズに進行・演出するためのプレゼンテーション支援ソフトウェアです。

- **Excelで作成した対戦データ**を読み込み、プロジェクターに美しく表示します。
- **2つの画面（運営者用・観客用）**を使い分け、裏方作業を見せずに進行できます。
- BGMやタイマー機能で、イベントを盛り上げます。
- オフライン環境でも安心して利用可能です。

---

## 2. ご利用の前に

### 必要な環境
- **OS:** Windows 10 以降
- **ソフトウェア:** Microsoft Excel（または互換ソフト）
  - ※試合データ（xlsx形式）の作成に必要です。

### インストール
1.  配布されたインストーラー（`.exe`ファイル）を実行します。
2.  画面の指示に従ってインストールを進めてください。
3.  デスクトップ等に作成されたショートカットから起動します。

---

## 3. 基本的な使い方

『Kuawase』を起動すると、2つのウィンドウが表示されます。

- **管理ウィンドウ:** 運営者が操作する画面です。
- **投影ウィンドウ:** 選手や観客に見せる画面です。プロジェクター等に接続して使います。

試合の準備から進行までの基本的な流れは以下の通りです。

### Step 1: 試合データ（Excel）の準備と読み込み

まず、対戦の組み合わせや句などを記載したExcelファイルを用意します。

1.  **管理ウィンドウ**の右側にある**「▶ Excelファイル管理」**をクリックして展開します。
2.  **「ファイルを選択」**ボタンを押し、準備したExcelファイル（`.xlsx`）を選びます。
3.  読み込みが成功すると、画面上部に「Excelデータを読み込みました！」と表示され、管理ウィンドウの表示が更新されます。

> **POINT**
> Excelのテンプレートは[こちら](https://github.com/blackstraysheep/Kuawase)で配布しています。

### Step 2: 対戦カードの指定

次に、これから行う対戦の情報を設定します。

1.  **管理ウィンドウ**の左下にある**「対戦指定パネル」**で、以下の項目を選択・入力します。
    *   **紅チーム / 白チーム:** Excelから読み込んだチーム名が表示されます。
    *   **兼題:** その対戦のお題です。
    *   **対戦名:** 「Aブロック 第1試合」のように、投影ウィンドウに表示される名前です。（改行したい場合は`<br>`と入力してください）
2.  **「保存」**ボタンを押すと、設定が投影ウィンドウに反映されます。

### Step 3: 試合の進行

準備が整ったら、試合の進行に合わせて画面を切り替えます。

1.  **管理ウィンドウ**の右上にある**「対戦切り替え」**パネルのボタンを使います。
    *   **大会TOP:** 大会全体のトップ画面を表示します。
    *   **対戦TOP:** 現在指定している対戦のトップ画面（チーム名や兼題）を表示します。
    *   **先鋒戦 ～ 大将戦:** 各対戦の画面に切り替わります。
2.  句を発表する際は**「披講（ひこう）」**パネルのボタンを使います。
    *   **紅 披講 / 白 披講:** 対応するチームの句を投影ウィンドウに大きく表示します。
    *   ※「披講」とは、句を読み上げて披露することです。

---

## 4. 便利な機能

### タイマー機能

シンキングタイムなどに使えるカウントダウンタイマーです。

- **場所:** 管理ウィンドウ > **「▼ タイマー」**
- **使い方:**
    1.  時間を設定し**「保存」**します。
    2.  **「スタート」「一時停止」「リセット」**で操作します。
    3.  タイマー終了時に指定のBGMを鳴らすこともできます。
- **ポイント:**
    - 上のタイマーが残り1分/0秒になると、運営者向けに「1分前」「そこまで」の合図が表示されます。（投影されません）
    - 使わないときは「▼ タイマー」をクリックすれば折りたたむことができます。

### BGM（音楽）の設定

シーンに合わせたBGMを再生し、イベントを演出できます。

- **場所:** 管理ウィンドウ > **「▶ BGMファイル管理」**
- **使い方:**
    1.  **「ファイル選択」**でPC内の音楽ファイル（mp3, wav等）を選び、**「アップロード」**します。
    2.  アップロードした曲が一覧に表示されます。
    3.  **「披講」「入場」**など、シーンごとに再生したい曲をプルダウンで選びます。
    4.  最後に**「BGM設定保存」**ボタンを押して設定を保存します。
- **BGMの再生:**
    - 管理ウィンドウの**「BGM再生」**パネルにある**「入場」「退場」「待機」**ボタンで、対応するBGMを好きなタイミングで再生できます。
    - **「待機ループ」**にチェックを入れると、「待機」BGMが**「停止」**ボタンを押すまで繰り返し再生されます。

### テーマカラーの変更

投影ウィンドウのデザインを、好みの配色に変更できます。

- **場所:** 管理ウィンドウ > **「▶ テーマカラー」**
- **使い方:** プルダウンから好きなテーマを選ぶと、即座に投影ウィンドウの配色が切り替わります。

### 表示言語の切り替え

管理ウィンドウの表示を日本語・英語で切り替えることができます。

- **場所:** 管理ウィンドウ > **「▶ Language」**
- **使い方:** **「日本語」「English」**ボタンを押すと、表示言語が切り替わります。

### データのリセット

読み込んだExcelデータや各種設定をすべて初期化したい場合に使用します。

- **場所:** 管理ウィンドウ > **「▶ Excelファイル管理」**
- **使い方:** **「初期化」**ボタンを押します。
- **注意:** アップロードしたBGMファイル自体は削除されません。BGMファイルを削除したい場合は、「BGMファイル管理」の一覧から個別に削除してください。

---

## 5. よくある質問（FAQ）

- **Q. Excelファイルを読み込んでも「選択されていません」と表示される**
  - A. これは正常な表示です。読み込みに成功すると画面上部にお知らせが表示され、大会名などが正しく反映されていれば問題ありません。

- **Q. BGMが鳴らない**
  - A. 「BGMファイル管理」で設定した後、**「BGM設定保存」**ボタンを押し忘れていないか確認してください。また、PC本体の音量がミュートになっていないかもご確認ください。

- **Q. タイマーやBGM管理パネルが邪魔…**
  - A. パネル名の横にある `▼` や `▶` のマークをクリックすると、各パネルを折りたたむことができます。

---

## 6. 開発・サポート

- **開発元:** BlackStraySheep
- **リポジトリ:** [https://github.com/blackstraysheep/Kuawase](https://github.com/blackstraysheep/Kuawase)
- 不具合の報告や機能の要望は、上記リポジトリの「Issues」までお寄せください。

---

## 【補足】Windowsでの投影設定

『Kuawase』をプロジェクターや外部モニターに投影して使用する場合、Windowsの「表示設定」を「拡張」にすることを推奨します。これにより、手元のPC画面に「管理ウィンドウ」を、プロジェクター側の画面に「投影ウィンドウ」をそれぞれ表示できます。

### 設定手順

1.  PCとプロジェクター（または外部モニター）をケーブルで接続します。
2.  キーボードの **`Windows` キー + `P` キー** を同時に押します。
3.  画面の右側に表示されるメニューから **「拡張」** を選択します。

<img src="https://raw.githubusercontent.com/blackstraysheep/Kuawase/main/img/win_display_setting.png" alt="Windows Display Setting" width="400"/>

4.  設定後、『Kuawase』の「投影ウィンドウ」だけをプロジェクター側の画面へドラッグ＆ドロップで移動し、最大化（または全画面表示）して使用してください。

> **もし「複製」を選ぶと…**
> PCとプロジェクターで全く同じ画面が表示されるため、観客に「管理ウィンドウ」が見えてしまいます。運営の裏側を見せないために、「拡張」モードの利用が便利です。
